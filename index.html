<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hounda Zone | Premium Streetwear</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700;900&display=swap');
        body { background-color: #ffffff; color: #000; font-family: 'Inter', sans-serif; }
        .hero-nav { padding: 40px 0; text-align: center; border-bottom: 1px solid #eee; }
        .brand-name { font-weight: 900; font-size: 3rem; letter-spacing: -2px; text-transform: uppercase; }
        .brand-tagline { font-size: 0.9rem; text-transform: uppercase; letter-spacing: 5px; color: #888; }
        
        /* كارت المنتج */
        .product-item { position: relative; margin-bottom: 40px; }
        .img-wrapper { position: relative; overflow: hidden; background: #f9f9f9; aspect-ratio: 3/4; cursor: pointer; }
        .product-img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.8s ease; }
        .product-item:hover .product-img { transform: scale(1.08); }
        .product-details { margin-top: 15px; text-align: center; }
        .product-title { font-weight: 700; font-size: 1.1rem; text-transform: uppercase; }
        .product-price { font-weight: 300; color: #555; }

        /* زر الـ 3 نقط والمنيو */
        .options-menu { position: absolute; top: 10px; right: 10px; z-index: 100; }
        .dots-btn { background: rgba(0,0,0,0.4); color: white; border: none; border-radius: 50%; width: 32px; height: 32px; font-size: 20px; cursor: pointer; }
        .delete-dropdown { display: none; position: absolute; right: 0; top: 38px; background: white; box-shadow: 0 4px 15px rgba(0,0,0,0.1); border-radius: 8px; overflow: hidden; border: 1px solid #eee; }
        .delete-dropdown button { background: none; border: none; padding: 12px 25px; color: #ff4444; font-weight: bold; cursor: pointer; white-space: nowrap; font-size: 14px; }
        .delete-dropdown button:hover { background: #fff5f5; }

        .admin-trigger { position: fixed; bottom: 40px; left: 40px; width: 50px; height: 50px; background: #000; color: #fff; border-radius: 50%; display: flex; align-items: center; justify-content: center; text-decoration: none; font-size: 24px; opacity: 0.3; transition: 0.3s; }
        .admin-trigger:hover { opacity: 1; transform: rotate(90deg); }
    </style>
</head>
<body>

    <header class="hero-nav">
        <div class="container">
            <h1 class="brand-name">HOUNDA<span style="color:#ffc107">.</span>ZONE</h1>
            <div class="brand-tagline">The Art of Streetwear</div>
        </div>
    </header>

    <main class="container mt-5">
        <div class="row g-5" id="products-list"></div>
    </main>

    <a href="admin.html" class="admin-trigger">+</a>

    <script>
        async function load() {
            const res = await fetch('/api/products');
            const data = await res.json();
            const list = document.getElementById('products-list');
            
            if(data.length === 0) {
                list.innerHTML = '<div class="text-center w-100 py-5 text-muted">EXCLUSIVITY IS COMING</div>';
                return;
            }

            list.innerHTML = data.map(p => `
                <div class="col-md-4 col-sm-6">
                    <div class="product-item">
                        <div class="options-menu">
                            <button class="dots-btn" onclick="toggleMenu(event, ${p.id})">⋮</button>
                            <div id="menu-${p.id}" class="delete-dropdown">
                                <button onclick="confirmDelete(event, ${p.id})">مسح هذا المنشور</button>
                            </div>
                        </div>
                        <div class="img-wrapper" onclick="location.href='details.html?id=${p.id}'">
                            <img src="${p.mainImage}" class="product-img">
                        </div>
                        <div class="product-details">
                            <div class="product-title">${p.title}</div>
                            <div class="product-price">${p.price} EGP</div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function toggleMenu(event, id) {
            event.stopPropagation();
            const menu = document.getElementById(`menu-${id}`);
            document.querySelectorAll('.delete-dropdown').forEach(m => { if(m !== menu) m.style.display = 'none'; });
            menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
        }

        async function confirmDelete(event, id) {
            event.stopPropagation();
            if(confirm('هل تريد مسح هذا المنشور نهائياً من براند هوندا زون؟')) {
                await fetch(`/api/product/${id}`, { method: 'DELETE' });
                load();
            }
        }

        document.addEventListener('click', () => {
            document.querySelectorAll('.delete-dropdown').forEach(m => m.style.display = 'none');
        });

        load();
    </script>
</body>
</html>